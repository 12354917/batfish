hostname R1

interface Serial1
 ip address 181.0.0.1 255.255.255.0
!
interface Serial2
 ip address 182.0.0.1 255.255.255.0
!
interface Serial3
 ip address 183.0.0.1 255.255.255.0
!
interface Serial4
 ip address 184.0.0.1 255.255.255.0
!
interface Serial5
 ip address 185.0.0.1 255.255.255.0
!
interface Serial6
 ip address 186.0.0.1 255.255.255.0
!
interface Serial7
 ip address 187.0.0.1 255.255.255.0
!
interface Serial8
 ip address 188.0.0.1 255.255.255.0
!
interface Serial9
 ip address 189.0.0.1 255.255.255.0
!
interface Serial10
 ip address 190.0.0.1 255.255.255.0
!
interface Serial11
 ip address 191.0.0.1 255.255.255.0
!

router bgp 1
 neighbor 181.0.0.1 remote-as 10
 neighbor 181.0.0.1 route-map TEST_UPDATE in
 neighbor 182.0.0.1 remote-as 20
 neighbor 182.0.0.1 route-map TEST_UPDATE in
 neighbor 183.0.0.1 remote-as 30
 neighbor 183.0.0.1 route-map TEST_UPDATE_IDEM in
 neighbor 184.0.0.1 remote-as 40
 neighbor 184.0.0.1 route-map TEST_PFX_LENGTH in
 neighbor 185.0.0.1 remote-as 50
 neighbor 185.0.0.1 route-map TEST_ADD1 in
 neighbor 186.0.0.1 remote-as 60
 neighbor 186.0.0.1 route-map TEST_ADD2 in
 neighbor 187.0.0.1 remote-as 70
 neighbor 187.0.0.1 route-map TEST_ADD3 in
 neighbor 188.0.0.1 remote-as 80
 neighbor 188.0.0.1 route-map TEST_COMMUTATIVE1 in
 neighbor 189.0.0.1 remote-as 90
 neighbor 189.0.0.1 route-map TEST_COMMUTATIVE2 in
 neighbor 190.0.0.1 remote-as 100
 neighbor 190.0.0.1 route-map TEST_ADD_REMOVE1 in
 neighbor 191.0.0.1 remote-as 110
 neighbor 191.0.0.1 route-map TEST_ADD_REMOVE2 in
!

ip community-list expanded as2_community permit _2:

route-map TEST_UPDATE permit 10
  match ip address prefix-list FOO
  set local-preference 1
!

route-map TEST_UPDATE_IDEM permit 10
  match ip address prefix-list FOO
  set local-preference 2
  set local-preference 1
!

route-map TEST_PFX_LENGTH permit 10
  match ip address prefix-list FOO2
  set local-preference 2
  set local-preference 1
!

route-map TEST_ADD1 permit 10
  set as-path prepend 1
  set as-path prepend 1 1
!

route-map TEST_ADD2 permit 10
  set as-path prepend 1 1 1
!

route-map TEST_ADD3 permit 10
  set as-path prepend 1
!

route-map TEST_COMMUTATIVE1 permit 10
 set metric 50
 set community 1:2 additive
!

route-map TEST_COMMUTATIVE2 permit 10
 set community 1:2 additive
 set metric 50
!
ip community-list standard list1 permit 1:2

route-map TEST_ADD_REMOVE1 permit 10
 set metric 50
 set comm-list list1 delete
!

route-map TEST_ADD_REMOVE2 permit 10
 set community 1:2 additive
 set comm-list list1 delete
 set metric 50
!


ip prefix-list FOO seq 10 deny 20.20.20.0/24 le 26
ip prefix-list FOO seq 20 permit 0.0.0.0/0 le 32

ip prefix-list FOO2 seq 10 deny 20.20.20.0/24 le 25
ip prefix-list FOO2 seq 10 deny 20.20.20.0/24 ge 25 le 26
ip prefix-list FOO2 seq 20 permit 0.0.0.0/0 le 32