!
hostname border
!
interface GigabitEthernet1/1
 ip address 192.168.11.1 255.255.255.0
 no shutdown
!
interface GigabitEthernet1/2
 ip address 192.168.12.1 255.255.255.0
 no shutdown
!
interface GigabitEthernet2/1
 ip address 192.168.21.1 255.255.255.0
 no shutdown
!
interface GigabitEthernet2/2
 ip address 192.168.22.1 255.255.255.0
 no shutdown
!
route-map rm-65001-in permit 100
 match ip address prefix-list pl-65001-specific
 set community 65000:1 65000:2
!
route-map rm-65001-in permit 200
 match ip address prefix-list pl-65001
 set community 65000:2
!
route-map rm-65001-in deny 300
!
route-map rm-65002-in permit 100
 match ip address prefix-list pl-65002-specific
 set community 65000:1 65000:2
!
route-map rm-65002-in permit 200
 match ip address prefix-list pl-65002
 set community 65000:2
!
route-map rm-65002-in deny 300
!
route-map rm-peer-out deny 100
 ! peer-specific
 match community 1
!
route-map rm-peer-out permit 200
 ! peer
 match community 2
!
route-map rm-peer-out deny 300
!
ip prefix-list pl-65001 permit 10.1.0.0/16
ip prefix-list pl-65001-specific permit 10.1.0.0/16 ge 24
!
!
ip prefix-list pl-65002 permit 10.2.0.0/16
ip prefix-list pl-65002-specific permit 10.2.0.0/16 ge 24
!
ip community-list 1 permit 65000:1
!
ip community-list 2 permit 65000:2
!
!
router bgp 65000
 neighbor as65001 peer-group
 neighbor as65001 remote-as 65001
 neighbor as65001 route-map rm-65001-in in
 neighbor as65001 route-map rm-peer-out out
 neighbor as65002 peer-group
 neighbor as65002 remote-as 65002
 neighbor as65002 route-map rm-65002-in in
 neighbor as65002 route-map rm-peer-out out
 neighbor 192.168.11.2 peer-group as65001
 neighbor 192.168.12.2 peer-group as65001
 neighbor 192.168.21.2 peer-group as65002
 neighbor 192.168.22.2 peer-group as65002
!

