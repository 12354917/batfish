# This demo operates over the example test rigs in the batfish repository.
# It assumes that it is being run from the top-level directory in the repository.
# Do this first, so you have the relevant shell commands
# % source tools/batfish_function.sh
# Select one of the two options below
## If you want to run analysis locally
## % allinone -runmode interactive
#
## If you want to run against www.batfish.org
## % batfish_client -runmode interactive
# load the testing
Init'ed and set active container to cp_7cf23a39-57a5-42e0-94a2-b070a976d12e
Uploaded testrig. Parsing now.
. . . . . . . . 
Status: SUCCESS
Question: null
{
  "class" : "org.batfish.datamodel.answers.ParseVendorConfigurationAnswerElement"
}
{
  "class" : "org.batfish.datamodel.answers.ConvertConfigurationAnswerElement",
  "undefinedReferences" : {
    "as2core2" : {
      "route-map" : [ "filter-bogons" ]
    }
  },
  "unusedStructures" : {
    "as1border1" : {
      "bgp group" : [ "as3" ],
      "community-list" : [ "as1_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as1border2" : {
      "bgp group" : [ "as2" ],
      "community-list" : [ "as1_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2border1" : {
      "bgp group" : [ "as3" ],
      "community-list" : [ "as2_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2border2" : {
      "bgp group" : [ "as1" ],
      "community-list" : [ "as2_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2dept1" : {
      "ip acl" : [ "105", "RESTRICT_HOST_TRAFFIC_OUT" ]
    },
    "as2dist1" : {
      "ip acl" : [ "102" ]
    },
    "as2dist2" : {
      "ip acl" : [ "102" ]
    },
    "as3border1" : {
      "bgp group" : [ "as1" ],
      "community-list" : [ "as3_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as3border2" : {
      "bgp group" : [ "as2" ],
      "community-list" : [ "as3_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    }
  },
  "warnings" : {
    "as1border1" : {
      "Red flags" : {
        "1" : "MISCELLANEOUS: Could not determine update source for BGP neighbor: '3.2.2.2'",
        "2" : "MISCELLANEOUS: Could not determine update source for BGP neighbor: '5.6.7.8'",
        "3" : "UNUSED: Unused bgp peer-group/template: 'as3'",
        "4" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "5" : "UNUSED: Unused expanded community-list: 'as1_community'"
      }
    },
    "as1border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as2'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as1_community'"
      }
    },
    "as2border1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as3'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as2_community'"
      }
    },
    "as2border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as1'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as2_community'"
      }
    },
    "as2core2" : {
      "Red flags" : {
        "1" : "UNDEFINED: neighbor: '2.1.1.1': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "2" : "UNDEFINED: neighbor: '2.1.3.1': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "3" : "UNDEFINED: neighbor: '2.1.1.2': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "4" : "UNDEFINED: neighbor: '2.1.3.2': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'"
      }
    },
    "as2dept1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '105'",
        "2" : "UNUSED: Unused extended access-list: 'RESTRICT_HOST_TRAFFIC_OUT'"
      }
    },
    "as2dist1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '102'"
      }
    },
    "as2dist2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '102'"
      }
    },
    "as3border1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as1'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as3_community'"
      }
    },
    "as3border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as2'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as3_community'"
      }
    }
  }
}
Base testrig is now tr_38942286-3b89-41a1-a253-df430ab5fa9f
Generating dataplane now
. . 
Status: SUCCESS
Question: null
Computation summary:
   OSPF-internal iterations: 8
   Dependent-routes iterations: 8
   BGP iterations: 8
   Total routes: 298

Generated dataplane
#####################
# our logical representation of the network that can be queried in various ways.
# we have many queries and can write more
# for example, we can ask simple questions on adjacencies
. 
Status: SUCCESS
Question: neighbors node1Regex=.* | node2Regex=.* | neighborType=[]
{
  "class" : "org.batfish.question.NeighborsQuestionPlugin$NeighborsAnswerElement",
  "lanNeighbors" : [ {
    "node1" : "as1border1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as1core1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as1border1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2border1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as1border2",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as1core1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as1border2",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as3border2",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as1core1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as1border1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as1core1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as1border2",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2border1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as1border1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2border1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2core1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2border1",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2core2",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2border2",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as3border1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2border2",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2core1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2border2",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2core2",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2core1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2border1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2core1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2border2",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2core1",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2dist2",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2core1",
    "node1interface" : "FastEthernet2/0",
    "node2" : "as2dist1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as2core2",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2border2",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2core2",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2border1",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2core2",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2dist1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2core2",
    "node1interface" : "FastEthernet2/0",
    "node2" : "as2dist2",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2dept1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2dist1",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2dept1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2dist2",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2dept1",
    "node1interface" : "FastEthernet1/0",
    "node2" : "host1",
    "node2interface" : "eth0"
  }, {
    "node1" : "as2dept1",
    "node1interface" : "FastEthernet1/1",
    "node2" : "host2",
    "node2interface" : "eth0"
  }, {
    "node1" : "as2dist1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2core2",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2dist1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2core1",
    "node2interface" : "FastEthernet2/0"
  }, {
    "node1" : "as2dist1",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2dept1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as2dist2",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2core2",
    "node2interface" : "FastEthernet2/0"
  }, {
    "node1" : "as2dist2",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as2core1",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "as2dist2",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as2dept1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as3border1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as2border2",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as3border1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as3core1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as3border2",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as3core1",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as3border2",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as1border2",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as3core1",
    "node1interface" : "FastEthernet0/0",
    "node2" : "as3border2",
    "node2interface" : "FastEthernet0/0"
  }, {
    "node1" : "as3core1",
    "node1interface" : "FastEthernet0/1",
    "node2" : "as3border1",
    "node2interface" : "FastEthernet0/1"
  }, {
    "node1" : "as3core1",
    "node1interface" : "FastEthernet1/0",
    "node2" : "as3core1",
    "node2interface" : "FastEthernet1/1"
  }, {
    "node1" : "as3core1",
    "node1interface" : "FastEthernet1/1",
    "node2" : "as3core1",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "host1",
    "node1interface" : "eth0",
    "node2" : "as2dept1",
    "node2interface" : "FastEthernet1/0"
  }, {
    "node1" : "host2",
    "node1interface" : "eth0",
    "node2" : "as2dept1",
    "node2interface" : "FastEthernet1/1"
  } ]
}
# --> can help ensure that adjacencies are as expected (i.e., interfaces are properly configured)
# we can also ask for protocol-level adjacencies
. 
Status: SUCCESS
Question: neighbors node1Regex=.* | node2Regex=.* | neighborType=[EBGP]
{
  "class" : "org.batfish.question.NeighborsQuestionPlugin$NeighborsAnswerElement",
  "ebgpNeighbors" : [ {
    "ip1" : "10.12.11.1",
    "ip2" : "10.12.11.2",
    "node1" : "as1border1",
    "node2" : "as2border1"
  }, {
    "ip1" : "10.13.22.1",
    "ip2" : "10.13.22.3",
    "node1" : "as1border2",
    "node2" : "as3border2"
  }, {
    "ip1" : "10.12.11.2",
    "ip2" : "10.12.11.1",
    "node1" : "as2border1",
    "node2" : "as1border1"
  }, {
    "ip1" : "10.23.21.2",
    "ip2" : "10.23.21.3",
    "node1" : "as2border2",
    "node2" : "as3border1"
  }, {
    "ip1" : "2.34.101.4",
    "ip2" : "2.34.101.3",
    "node1" : "as2dept1",
    "node2" : "as2dist1"
  }, {
    "ip1" : "2.34.201.4",
    "ip2" : "2.34.201.3",
    "node1" : "as2dept1",
    "node2" : "as2dist2"
  }, {
    "ip1" : "2.34.101.3",
    "ip2" : "2.34.101.4",
    "node1" : "as2dist1",
    "node2" : "as2dept1"
  }, {
    "ip1" : "2.34.201.3",
    "ip2" : "2.34.201.4",
    "node1" : "as2dist2",
    "node2" : "as2dept1"
  }, {
    "ip1" : "10.23.21.3",
    "ip2" : "10.23.21.2",
    "node1" : "as3border1",
    "node2" : "as2border2"
  }, {
    "ip1" : "10.13.22.3",
    "ip2" : "10.13.22.1",
    "node1" : "as3border2",
    "node2" : "as1border2"
  } ]
}
# --> can help ensure that protocol sessions are configured correctly
##############
# we can also do other simple checks based on best practices of our network
# this will check if all interface ips are unique
. 
Status: SUCCESS
Question: uniqueipassignments nodeRegex=".*" | verbose=false
{
  "class" : "org.batfish.question.UniqueIpAssignmentsQuestionPlugin$UniqueIpAssignmentsAnswerElement",
  "allIps" : {
    "2.1.1.2" : [ {
      "hostname" : "as2border2",
      "interface" : "Loopback0"
    }, {
      "hostname" : "as2dept1",
      "interface" : "Loopback0"
    } ]
  },
  "enabledIps" : {
    "2.1.1.2" : [ {
      "hostname" : "as2border2",
      "interface" : "Loopback0"
    }, {
      "hostname" : "as2dept1",
      "interface" : "Loopback0"
    } ]
  }
}
# this will check if all loopbacks are being correctly announced within OSPF
. 
Status: SUCCESS
Question: ospfLoopbacks nodeRegex=".*"
{
  "class" : "org.batfish.question.OspfLoopbacksQuestionPlugin$OspfLoopbacksAnswerElement",
  "active" : {
    "as1border1" : [ "Loopback0" ],
    "as1border2" : [ "Loopback0" ],
    "as1core1" : [ "Loopback0" ],
    "as2border1" : [ "Loopback0" ],
    "as2border2" : [ "Loopback0" ],
    "as2core1" : [ "Loopback0" ],
    "as2core2" : [ "Loopback0" ],
    "as2dist1" : [ "Loopback0" ],
    "as2dist2" : [ "Loopback0" ],
    "as3border1" : [ "Loopback0" ],
    "as3border2" : [ "Loopback0" ],
    "as3core1" : [ "Loopback0" ]
  },
  "inactive" : {
    "as2dept1" : [ "Loopback0" ]
  },
  "running" : {
    "as1border1" : [ "Loopback0" ],
    "as1border2" : [ "Loopback0" ],
    "as1core1" : [ "Loopback0" ],
    "as2border1" : [ "Loopback0" ],
    "as2border2" : [ "Loopback0" ],
    "as2core1" : [ "Loopback0" ],
    "as2core2" : [ "Loopback0" ],
    "as2dist1" : [ "Loopback0" ],
    "as2dist2" : [ "Loopback0" ],
    "as3border1" : [ "Loopback0" ],
    "as3border2" : [ "Loopback0" ],
    "as3core1" : [ "Loopback0" ]
  }
}
################
# more interestingly, we can also ask questions about data flow, i.e., the end-to-end impact of all configuration
# for example, we can see how host1 reaches a particular IP address
# the query will take time if the dataplane has not been comptued before
. 
Status: SUCCESS
Question: traceroute ingressNode=host1 | dstIp=1.0.2.2
Flow: ingress:host1 2.128.0.101->1.0.2.2 IP state:NEW
  environment:BASE
    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 6: as1border1:FastEthernet0/0 -> as1core1:FastEthernet0/0 --- [OspfIntraAreaRoute<1.0.2.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 6: as1border1:FastEthernet0/0 -> as1core1:FastEthernet0/0 --- [OspfIntraAreaRoute<1.0.2.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 6: as1border1:FastEthernet0/0 -> as1core1:FastEthernet0/0 --- [OspfIntraAreaRoute<1.0.2.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<1.0.2.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.2.0/24>]
    Hop 6: as1border1:FastEthernet0/0 -> as1core1:FastEthernet0/0 --- [OspfIntraAreaRoute<1.0.2.0/24>]
    ACCEPTED


# (the macro above expands to "get traceroute ingressNode=host1 | dstIp=1.0.2.2")
# --> unlike a regular traceroute we show multipath and interface information
# suppose host1 (2.128.0.101) is running DNS and we want to ensure that the server is reachable
# can easily do this using protocol-specific traceroutes
. 
Status: SUCCESS
Question: traceroute ingressNode=as2border1 | dstIp=2.128.0.101 | dstPort=53 | ipProtocol=UDP
Flow: ingress:as2border1 2.1.1.1->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED


################
# while the above could be done using testing/emulation, we alone can be comprehensive
# for example, find *all* (starting node, packet header) combinations where the DNS server is unreachable
. . . . . . . . 
Status: SUCCESS
Question: reachability actions=[DROP] | dstPorts=[[53,53]] | dstIps=[2.128.0.101] | ipProtocols=[UDP]
Flow: ingress:as1border1 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:as1border2 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:as1core1 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:as3border1 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:as3border2 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:as3core1 2.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip 2.0.0.0 0.255.255.255 any}

Flow: ingress:host2 0.0.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: host2:eth0 -> (none):null_interface --- [StaticRoute<0.0.0.0/0>]
    DENIED_OUT{filter::OUTPUT}{line:0}


# (macro expands to "get reachability dstPrefixes=["2.128.0.101/32"] | dstPortRange=["53-53"] | ipProtoRange=["17-17"] | actions=["drop"])
# --> the output shows outsiders with spoofed source addresses cannot reach the DNS server (good)
# --> but also shows that a bad ACL on host2 is blocking access (bad)
# another example: host2 (2.128.1.101) is running SSH. we can run similar queries to learn who cannot reach it
# but we can also ensure that non-ssh traffic can *never* reach host2
. . . . . . . 
Status: SUCCESS
Question: reachability actions=[ACCEPT] | dstIps=[2.128.1.101] | notDstPorts=[[22,22]] | notIpProtocols=[TCP]
Flow: ingress:host2 0.0.0.0->2.128.1.101 ICMP icmpType:255 icmpCode:255 state:NEW
  environment:BASE
    ACCEPTED


# --> all good! hard to guarantee with testing but easy for us
# another example: we also want to ensure that outsiders can *never* reach the SSH server
# we have ACLs on as2's border routers to prevent this. to test that things are correctly implemented:
. . 
Status: SUCCESS
Question: reachability actions=[ACCEPT] | dstPorts=[[22,22]] | dstIps=[2.128.1.101] | ingressNodeRegex=.* | ipProtocols=[TCP]
Flow: ingress:as3border1 253.0.0.0->2.128.1.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED


# --> buggy ACL on as2border2!
#############
# comparing two sets of configs (e.g., current + planned) is a powerful debugging aid
# initialize the delta environment and generate its dataplane
Active delta testrig->environment is now tr_38942286-3b89-41a1-a253-df430ab5fa9f->env_4c9545da-649e-48dc-a469-c9186fd8c318
. . . . . 
Status: SUCCESS
Question: null
{
  "class" : "org.batfish.datamodel.answers.ParseVendorConfigurationAnswerElement"
}
{
  "class" : "org.batfish.datamodel.answers.ConvertConfigurationAnswerElement",
  "undefinedReferences" : {
    "as2core2" : {
      "route-map" : [ "filter-bogons" ]
    }
  },
  "unusedStructures" : {
    "as1border1" : {
      "bgp group" : [ "as3" ],
      "community-list" : [ "as1_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as1border2" : {
      "bgp group" : [ "as2" ],
      "community-list" : [ "as1_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2border1" : {
      "bgp group" : [ "as3" ],
      "community-list" : [ "as2_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2border2" : {
      "bgp group" : [ "as1" ],
      "community-list" : [ "as2_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as2dept1" : {
      "ip acl" : [ "105" ]
    },
    "as2dist1" : {
      "ip acl" : [ "102" ]
    },
    "as2dist2" : {
      "ip acl" : [ "102" ]
    },
    "as3border1" : {
      "bgp group" : [ "as1" ],
      "community-list" : [ "as3_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    },
    "as3border2" : {
      "bgp group" : [ "as2" ],
      "community-list" : [ "as3_community" ],
      "prefix-list" : [ "inbound_route_filter" ]
    }
  },
  "warnings" : {
    "as1border1" : {
      "Red flags" : {
        "1" : "MISCELLANEOUS: Could not determine update source for BGP neighbor: '3.2.2.2'",
        "2" : "MISCELLANEOUS: Could not determine update source for BGP neighbor: '5.6.7.8'",
        "3" : "UNUSED: Unused bgp peer-group/template: 'as3'",
        "4" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "5" : "UNUSED: Unused expanded community-list: 'as1_community'"
      }
    },
    "as1border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as2'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as1_community'"
      }
    },
    "as2border1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as3'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as2_community'"
      }
    },
    "as2border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as1'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as2_community'"
      }
    },
    "as2core2" : {
      "Red flags" : {
        "1" : "UNDEFINED: neighbor: '2.1.1.1': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "2" : "UNDEFINED: neighbor: '2.1.3.1': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "3" : "UNDEFINED: neighbor: '2.1.1.2': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'",
        "4" : "UNDEFINED: neighbor: '2.1.3.2': group: 'as2': undefined reference to inbound route-map: 'filter-bogons'"
      }
    },
    "as2dept1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '105'"
      }
    },
    "as2dist1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '102'"
      }
    },
    "as2dist2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused extended access-list: '102'"
      }
    },
    "as3border1" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as1'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as3_community'"
      }
    },
    "as3border2" : {
      "Red flags" : {
        "1" : "UNUSED: Unused bgp peer-group/template: 'as2'",
        "2" : "UNUSED: Unused prefix-list: 'inbound_route_filter'",
        "3" : "UNUSED: Unused expanded community-list: 'as3_community'"
      }
    }
  }
}
Generating delta dataplane
. 
Status: SUCCESS
Question: null
Computation summary:
   OSPF-internal iterations: 8
   Dependent-routes iterations: 8
   BGP iterations: 8
   Total routes: 301

Generated delta dataplane
# any earlier query can be executed differentially, to see if how behavior differs
. 
Status: SUCCESS
Question: neighbors differential=true | node1Regex=.* | node2Regex=.* | neighborType=[]
{
  "class" : "org.batfish.datamodel.answers.JsonDiffAnswerElement",
  "jsonDiff" : { }
}
# a particularly powerful query: reachability diff between the two environments
. . . . . . . . . . . . . 
Status: SUCCESS
Question: reachability differential=true | actions=[ACCEPT] | type=REDUCED_REACHABILITY
Flow: ingress:as1border1 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as1border2 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as1core1 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2border1 253.127.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2border2 253.123.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2core1 253.123.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2core2 253.127.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2dept1 253.63.0.0->2.128.0.101 UDP sport:0 dport:DOMAIN(53) state:NEW
  environment:BASE
    Hop 1: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2dist1 253.127.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as2dist2 253.127.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 2: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as3border1 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as3border2 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 7: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

Flow: ingress:as3core1 253.0.0.0->2.128.0.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> host1:eth0 --- [ConnectedRoute<2.128.0.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 4: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/24>]
    Hop 6: as2dept1:FastEthernet1/0 -> (none):null_interface --- [ConnectedRoute<2.128.0.0/24>]
    DENIED_OUT{RESTRICT_HOST_TRAFFIC_IN}{deny ip any any}


# --> any collateral damage is easy to see
#############
# fault-tolerance can be ensured in a similar manner by studying the impact of failures
# this command creates a network view after an interface failure
. 
Status: SUCCESS
Question: {
  "class" : "org.batfish.question.EnvironmentCreationQuestionPlugin$EnvironmentCreationQuestion",
  "environmentName" : "env_e39a3c8d-59b8-45b8-99ad-1510600b8d8b",
  "interfaceBlacklist" : [ {
    "hostname" : "as2border2",
    "interface" : "FastEthernet0/0"
  } ]
}
New environment: 'env_e39a3c8d-59b8-45b8-99ad-1510600b8d8b' successfully created from old environment: 'env_default' with supplied parameters
Active delta testrig->environment is now tr_38942286-3b89-41a1-a253-df430ab5fa9f->env_e39a3c8d-59b8-45b8-99ad-1510600b8d8b
# we can see if reachability changes at all after this failure
. . . . . . . . . . . . . 
Status: SUCCESS
Question: reachability differential=true | actions=[ACCEPT] | type=REDUCED_REACHABILITY
Flow: ingress:as2border1 2.0.0.0->3.0.2.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

    Hop 1: as2border1:FastEthernet1/0 -> as2core2:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2border2 2.0.0.0->3.0.1.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2core1 2.0.0.0->3.0.2.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 4: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2core2 2.0.0.0->3.0.2.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 4: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2dept1 2.0.0.0->3.0.1.2 UDP sport:0 dport:65484 state:NEW
  environment:BASE
    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2dist1 2.0.0.0->3.0.2.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

    Hop 1: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as2dist2 2.0.0.0->3.0.2.1 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

    Hop 1: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 4: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [OspfIntraAreaRoute<3.0.2.0/24>]
    Hop 5: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [ConnectedRoute<3.0.2.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.2.0/24>]
    Hop 2: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.2.0/24>]
    Hop 3: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.2.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:as3border1 253.0.0.0->2.128.1.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 3: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border2:FastEthernet0/1 -> as1border2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 5: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 6: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip any host 2.128.1.101}

Flow: ingress:as3border2 253.0.0.0->2.128.1.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 7: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 7: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 7: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3border2:FastEthernet0/0 -> as3core1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 7: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3border2:FastEthernet0/1 -> as1border2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip any host 2.128.1.101}

Flow: ingress:as3core1 253.0.0.0->2.128.1.101 TCP sport:0 dport:SSH(22) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2core1:FastEthernet1/0 -> as2dist2:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2core1:FastEthernet2/0 -> as2dist1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dist1:FastEthernet1/0 -> as2dept1:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

    Hop 1: as3core1:FastEthernet0/1 -> as3border1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border1:FastEthernet0/0 -> as2border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as2border2:FastEthernet1/0 -> as2core2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 4: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [BgpRoute<2.128.1.0/24>]
    Hop 5: as2dist2:FastEthernet1/0 -> as2dept1:FastEthernet0/1 --- [BgpRoute<2.128.1.0/24>]
    Hop 6: as2dept1:FastEthernet1/1 -> host2:eth0 --- [ConnectedRoute<2.128.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: as3core1:FastEthernet0/0 -> as3border2:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 2: as3border2:FastEthernet0/1 -> as1border2:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 3: as1border2:FastEthernet0/0 -> as1core1:FastEthernet0/1 --- [BgpRoute<2.128.0.0/16>]
    Hop 4: as1core1:FastEthernet0/0 -> as1border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    Hop 5: as1border1:FastEthernet0/1 -> as2border1:FastEthernet0/0 --- [BgpRoute<2.128.0.0/16>]
    DENIED_IN{OUTSIDE_TO_INSIDE}{deny ip any host 2.128.1.101}

Flow: ingress:host1 2.128.0.0->3.0.1.2 UDP sport:0 dport:0 state:NEW
  environment:BASE
    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

Flow: ingress:host2 2.128.0.0->3.0.1.2 ICMP icmpType:255 icmpCode:255 state:NEW
  environment:BASE
    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/1 -> as2border2:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border2:FastEthernet0/0 -> as3border1:FastEthernet0/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 6: as3border1:FastEthernet0/1 -> as3core1:FastEthernet0/1 --- [ConnectedRoute<3.0.1.0/24>]
    ACCEPTED

  environment:DELTA
    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<3.0.1.0/24>]
    Hop 4: as2core1:FastEthernet0/0 -> as2border1:FastEthernet0/1 --- [BgpRoute<3.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> (none):null_interface --- [BgpRoute<3.0.1.0/24>]
    DENIED_OUT{INSIDE_TO_OUTSIDE}{deny ip any any}


# --> any lack of fault tolerance is easy to see
##############
# finally, sanity checking can be done in the data plane too (e.g., valley-free routing in the DC, number of hops)
# a powerful example: multipath consistency.
. . . . . . . . 
Status: SUCCESS
Question: reachability actions=[ACCEPT] | type=MULTIPATH
Flow: ingress:as2core2 0.0.0.0->2.1.2.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2core2:FastEthernet0/0 -> as2border2:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    Hop 2: as2border2:FastEthernet0/1 -> as2core1:FastEthernet0/1 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    ACCEPTED

    Hop 1: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    Hop 2: as2border1:FastEthernet0/1 -> as2core1:FastEthernet0/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    ACCEPTED

    Hop 1: as2core2:FastEthernet1/0 -> as2dist1:FastEthernet0/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    Hop 2: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

    Hop 1: as2core2:FastEthernet2/0 -> as2dist2:FastEthernet0/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    Hop 2: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.2.1/32>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

Flow: ingress:as2dept1 2.0.0.0->1.0.1.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 2: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 2: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

Flow: ingress:as2dist1 2.0.0.0->2.1.1.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    Hop 2: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    ACCEPTED

    Hop 1: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

Flow: ingress:as2dist2 2.0.0.0->2.1.1.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    Hop 2: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    ACCEPTED

    Hop 1: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [OspfIntraAreaRoute<2.1.1.1/32>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

Flow: ingress:host1 2.128.0.0->1.0.1.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: host1:eth0 -> as2dept1:FastEthernet1/0 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

Flow: ingress:host2 2.128.0.0->1.0.1.1 TCP sport:0 dport:TELNET(23) state:NEW tcpFlags:00000000
  environment:BASE
    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/0 -> as2core2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/0 -> as2dist1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist1:FastEthernet0/1 -> as2core1:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/0 -> as2core2:FastEthernet2/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 4: as2core2:FastEthernet0/1 -> as2border1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 5: as2border1:FastEthernet0/0 -> as1border1:FastEthernet0/1 --- [BgpRoute<1.0.1.0/24>]
    ACCEPTED

    Hop 1: host2:eth0 -> as2dept1:FastEthernet1/1 --- [StaticRoute<0.0.0.0/0>]
    Hop 2: as2dept1:FastEthernet0/1 -> as2dist2:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    Hop 3: as2dist2:FastEthernet0/1 -> as2core1:FastEthernet1/0 --- [BgpRoute<1.0.1.0/24>]
    DENIED_IN{blocktelnet}{deny   tcp any any eq telnet}


# --> will catch hard-to-debug, bad interactions between routing and ACLs
